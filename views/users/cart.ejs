<%- include ('../layouts/header') %>
    <div class="header-small-mobile section-padding-1">
        <div class="container-fluid">
            <div class="row align-items-center">
                <div class="col-6">
                    <div class="mobile-logo logo-width">
                        <a href="index.html">
                            <img alt="" src="assets/images/logo/logo.png">
                        </a>
                    </div>
                </div>
                <div class="col-6">
                    <div class="mobile-header-right-wrap">
                        <div class="header-right-wrap header-right-flex">
                            <div class="same-style cart-wrap">
                                <a href="#" class="cart-active">
                                    <i class="dlicon shopping_bag-20"></i>
                                    <span class="count-style"><%= cart.items.length %></span>
                                </a>
                            </div>
                            <div class="same-style header-off-canvas">
                                <a class="header-aside-button" href="#">
                                    <i class="dlicon ui-3_menu-left"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- search start -->
    <div class="search-content-wrap main-search-active">
        <a class="search-close"><i class="dlicon ui-1_simple-remove"></i></a>
        <div class="search-content">
            <p>Start typing and press Enter to search</p>
            <form class="search-form" action="/allProducts" method="GET">
                <input type="text" name="q" placeholder="Search">
                <button class="button-search" type="submit"><i class="dlicon ui-1_zoom"></i></button>
            </form>
        </div>
    </div>
    <!-- mini cart start -->
    <div class="sidebar-cart-active">
        <div class="sidebar-cart-all">
            <a class="cart-close" href="#"><i class="dlicon ui-1_simple-remove"></i></a>
            <div class="cart-content">
                <h3>Shopping Cart</h3>
                <ul>
                    <% if (cart && cart.items.length> 0) { %>
                        <% cart.items.forEach(item=> { %>
                            <li class="single-product-cart">
                                <div class="cart-img">
                                    <a href="#">
                                        <img src="/admin/productImages/<%= item.product.images && item.product.images[0] %>"
                                            alt="<%= item.product.name %>" height="90px" width="90px">
                                    </a>
                                </div>
                                <div class="cart-title">
                                    <h4><a href="#">
                                            <%= item.product.name %>
                                        </a></h4>
                                    <span>
                                        <%= item.quantity %> × $<%= item.product.discountPrice || item.product.price %>
                                    </span>
                                </div>
                                <div class="cart-delete">
                                    <a href="#">×</a>
                                </div>
                            </li>
                            <% }) %>
                                <% } else { %>
                                    <li>Your cart is empty</li>
                                    <% } %>
                </ul>
                <div class="cart-total">
                    <h4>Subtotal: <span>₹<%= subtotal %></span></h4>
                </div>
                <div class="cart-checkout-btn">
                    <a class="btn-hover cart-btn-style" href="/cart">view cart</a>
                    <a class="no-mrg btn-hover cart-btn-style" href="/order">checkout</a>
                </div>
            </div>
        </div>
    </div>
    <!-- aside start -->
    <div class="header-aside-active">
        <div class="header-aside-wrap">
            <a class="aside-close"><i class="dlicon ui-1_simple-remove"></i></a>
            <div class="header-aside-content">
                <div class="mobile-menu-area">
                    <div class="mobile-search">
                        <form class="search-form" action="#">
                            <input type="text" placeholder="Search entire store…">
                            <button class="button-search"><i class="dlicon ui-1_zoom"></i></button>
                        </form>
                    </div>
                    <div class="mobile-menu-wrap">
                        <!-- mobile menu start -->
                        <div class="mobile-navigation">
                            <!-- mobile menu navigation start -->
                            <nav>
                                <ul class="mobile-menu">
                                    <li class="menu-item-has-children"><a href="/home">Home</a></li>
                                    <li class="menu-item-has-children "><a href="/allProducts">shop</a></li>
                                    <li class="menu-item-has-children"><a href="/wishlist">Wishlist</a></li>
                                </ul>
                            </nav>
                            <!-- mobile menu navigation end -->
                        </div>
                        <!-- mobile menu end -->
                    </div>
                    <div class="mobile-curr-lang-wrap">
                        <div class="single-mobile-curr-lang">
                            <a class="mobile-account-active" href="#">My Account <i class="fa fa-angle-down"></i></a>
                            <div class="lang-curr-dropdown account-dropdown-active">
                                <ul>
                                    <li><a href="/my-account">My Account</a></li>
                                    <li><a href="/logout">Logout</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="header-aside-menu">
                    <nav>
                        <ul>
                            <li><a href="#">About Toro</a></li>
                            <li><a href="#">Help Center</a></li>
                            <li><a href="#">Collection</a></li>
                            <li><a href="#">Blog</a></li>
                            <li><a href="#">New Look</a></li>
                        </ul>
                    </nav>
                </div>
                <img src="assets/images/icon-img/payments.png" alt="payment">
                <p>Pellentesque mollis nec orci id tincidunt. Sed mollis risus eu nisi aliquet, sit amet fermentum justo
                    dapibus.</p>
                <div class="aside-contact-info">
                    <ul>
                        <li><i class="dlicon ui-2_time-clock"></i>Monday - Friday: 9:00 - 19:00</li>
                        <li><i class="dlicon ui-1_email-84"></i>Info@la-studioweb.com</li>
                        <li><i class="dlicon tech-2_rotate"></i>(+55) 254. 254. 254</li>
                        <li><i class="dlicon ui-1_home-minimal"></i>Helios Tower 75 Tam Trinh Hoang - Ha Noi - Viet Nam
                        </li>
                    </ul>
                </div>
                <div class="social-icon-style mb-25">
                    <a class="facebook" href="#"><i class="fa fa-facebook"></i></a>
                    <a class="twitter" href="#"><i class="fa fa-twitter"></i></a>
                    <a class="google-plus" href="#"><i class="fa fa-google-plus"></i></a>
                    <a class="behance" href="#"><i class="fa fa-behance"></i></a>
                </div>
                <div class="copyright">
                    <p>© 2021 <a href="https://hasthemes.com/">Toro.</a> All rights reserved</p>
                </div>
            </div>
        </div>
    </div>
    <div class="breadcrumb-area section-padding-1 bg-gray breadcrumb-ptb-1">
        <div class="container-fluid">
            <div class="breadcrumb-content text-center">
                <div class="breadcrumb-title">
                    <h2>Shopping Cart</h2>
                </div>
                <ul>
                    <li>
                        <a href="index.html">Home 01 </a>
                    </li>
                    <li><span> &gt; </span></li>
                    <li class="active"> Shopping Cart </li>
                </ul>
            </div>
        </div>
    </div>
    <!-- cart start -->
    <div class="cart-main-area pt-90 pb-100">
        <div class="container">
            <div class="row">
                <div class="col-lg-12 col-md-12 col-sm-12 col-12">
                    <form action="#">
                        <div class="row">
                            <div class="col-lg-8">
                                <div class="table-content table-responsive cart-table-content">
                                    <table>
                                        <thead>
                                            <tr>
                                                <th></th>
                                                <th></th>
                                                <th>Product</th>
                                                <th> Price</th>
                                                <th>Quantity</th>
                                                <th>total</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <% if (items.length === 0) { %>
                                                <tr>
                                                    <td colspan="6">Your cart is empty.</td>
                                                </tr>
                                            <% } else { %>
                                                <% items.forEach(function(item) { %>
                                                <tr>
                                                    <td class="product-remove">
                                                        <a href="/delete-cart-item/<%= item._id %>">
                                                            <i class="dlicon ui-1_simple-remove"></i>
                                                        </a>
                                                    </td>
                                                    <td class="product-img">
                                                        <% if (item.product && item.product.images && item.product.images.length > 0) { %>
                                                            <img src="/admin/productImages/<%= item.product.images[0] %>" alt="<%= item.product.name %>" height="90px" width="90px">
                                                        <% } else { %>
                                                            <img src="defaultImage.jpg" alt="No Image" height="90px" width="90px">
                                                        <% } %>
                                                    </td>
                                                    
                                                    <td class="product-name"><a href="#"><%= item.product.name %></a></td>
                                                    <td class="product-price"><span class="amount">₹<%= item.product.discountPrice %></span></td>
                                                    <td class="cart-quality">
                                                        <!-- <div class="product-details-quality quality-width-cart">
                                                            <div class="cart-plus-minus">
                                                                <input class="cart-plus-minus-box" type="text" name="qtybutton" value="<%= item.quantity %>">
                                                            </div>
                                                        </div> -->
                                                        <button class="cart-item-count mr-12" onclick="changeQuantity('<%= item._id %>', -1 ,'<%= item.quantity %>', '<%= item.product.stock %>')">-</button><%= item.quantity %><button class="cart-item-count ml-12" onclick="changeQuantity('<%= item._id %>', +1 ,'<%= item.quantity %>', '<%= item.product.stock %>')">+</button>
                                                    </td>
                                                    <td class="product-total"><span>₹<%= (item.product.discountPrice * item.quantity).toFixed(2) %></span></td>
                                                </tr>
                                                <% }); %>
                                            <% } %>
                                            <!-- <tr>
                                                <td class="product-remove">
                                                    <a href="#"><i class="dlicon ui-1_simple-remove"></i></a>
                                                </td>
                                                <td class="product-img">
                                                    <a href="#"><img src="assets/images/cart/cart-2.jpg" alt=""></a>
                                                </td>
                                                <td class="product-name"><a href="#">High Collar Jacket</a></td>
                                                <td class="product-price"><span class="amount">$26.00</span></td>
                                                <td class="cart-quality">
                                                    <div class="product-details-quality quality-width-cart">
                                                        <div class="cart-plus-minus">
                                                            <input class="cart-plus-minus-box" type="text"
                                                                name="qtybutton" value="2">
                                                        </div>
                                                    </div>
                                                </td>
                                                <td class="product-total"><span>$110.00</span></td>
                                            </tr> -->
                                        </tbody>
                                    </table>
                                </div>
                                <!-- <div class="cart-shiping-update-wrapper">
                                    <div class="discount-code">
                                        <input type="text" name="name" placeholder="Coupon code">
                                        <button class="coupon-btn" type="submit">Apply coupon</button>
                                    </div>
                                    <div class="cart-clear">
                                        <a href="#">Clear Cart</a>
                                        <a href="#">Update cart</a>
                                    </div>
                                </div> -->
                            </div>
                            <div class="col-lg-4">
                                <div class="grand-total-wrap">
                                    <h4>Cart totals</h4>
                                    <div class="grand-total-content">
                                        <ul>
                                            <li>Subtotal <span>₹<%= subtotal %></span></li>
                                            <li style="color: green;">Discount <span>₹<%= totalDiscount %></span></li>
                                            <li>Total <span>₹<%= total %></span></li>
                                        </ul>
                                    </div>
                                    <div class="grand-btn">
                                        <a href="/order">Proceed to checkout</a>
                                    </div>
                                </div>
                            </div>                            
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <%- include ('../layouts/footer') %>