<%- include ('../layouts/header') %>
    <div class="header-small-mobile section-padding-1">
        <div class="container-fluid">
            <div class="row align-items-center">
                <div class="col-6">
                    <div class="mobile-logo logo-width">
                        <a href="/home">
                            <img alt="" src="assets/images/logo/logo.png">
                        </a>
                    </div>
                </div>
                <div class="col-6">
                    <div class="mobile-header-right-wrap">
                        <div class="header-right-wrap header-right-flex">
                            <div class="same-style cart-wrap">
                                <a href="#" class="cart-active">
                                    <i class="dlicon shopping_bag-20"></i>
                                    <span class="count-style">02</span>
                                </a>
                            </div>
                            <div class="same-style header-off-canvas">
                                <a class="header-aside-button" href="#">
                                    <i class="dlicon ui-3_menu-left"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- search start -->
    <div class="search-content-wrap main-search-active">
        <a class="search-close"><i class="dlicon ui-1_simple-remove"></i></a>
        <div class="search-content">
            <p>Start typing and press Enter to search</p>
            <form class="search-form" action="/allProducts" method="GET">
                <input type="text" name="q" placeholder="Search" value="<%= query %>">
                <button class="button-search" type="submit"><i class="dlicon ui-1_zoom"></i></button>
            </form>
        </div>
    </div>

    <!-- mini cart start -->
    <div class="sidebar-cart-active">
        <div class="sidebar-cart-all">
            <a class="cart-close" href="#"><i class="dlicon ui-1_simple-remove"></i></a>
            <div class="cart-content">
                <h3>Shopping Cart</h3>
                <ul>
                    <% if (cart && cart.items.length> 0) { %>
                        <% cart.items.forEach(item=> { %>
                            <li class="single-product-cart">
                                <div class="cart-img">
                                    <a href="#">
                                        <img src="/admin/productImages/<%= item.product.images && item.product.images[0] %>"
                                            alt="<%= item.product.name %>" height="90px" width="90px">
                                    </a>
                                </div>
                                <div class="cart-title">
                                    <h4><a href="#">
                                            <%= item.product.name %>
                                        </a></h4>
                                    <span>
                                        <%= item.quantity %> × $<%= item.product.discountPrice || item.product.price %>
                                    </span>
                                </div>
                                <div class="cart-delete">
                                    <a href="#">×</a>
                                </div>
                            </li>
                            <% }) %>
                                <% } else { %>
                                    <li>Your cart is empty</li>
                                    <% } %>
                </ul>



                <div class="cart-total">
                    <h4>Subtotal: <span>₹<%= subtotal %></span></h4>
                </div>
                
                <div class="cart-checkout-btn">
                    <a class="btn-hover cart-btn-style" href="/cart">view cart</a>
                    <a class="no-mrg btn-hover cart-btn-style" href="/order">checkout</a>
                </div>
            </div>
        </div>
    </div>
    <!-- aside start -->
    <div class="header-aside-active">
        <div class="header-aside-wrap">
            <a class="aside-close"><i class="dlicon ui-1_simple-remove"></i></a>
            <div class="header-aside-content">
                <div class="mobile-menu-area">
                    <div class="mobile-search">
                        <form class="search-form" action="#">
                            <input type="text" placeholder="Search entire store…">
                            <button class="button-search"><i class="dlicon ui-1_zoom"></i></button>
                        </form>
                    </div>
                    <div class="mobile-menu-wrap">
                        <!-- mobile menu start -->
                        <div class="mobile-navigation">
                            <!-- mobile menu navigation start -->
                            <nav>
                                <ul class="mobile-menu">
                                    <li class="menu-item-has-children"><a href="/home">Home</a>
                                        <ul class="dropdown">
                                            <li class="menu-item-has-children"><a href="#">Demo Group 01</a>
                                                <ul class="dropdown">
                                                    <li><a href="index.html">Home 01</a></li>
                                                    <li><a href="index-2.html">Home 02</a></li>
                                                    <li><a href="index-3.html">Home 03</a></li>
                                                    <li><a href="index-4.html">Home 04</a></li>
                                                    <li><a href="index-5.html">Home 05</a></li>
                                                    <li><a href="index-6.html">Home 06</a></li>
                                                </ul>
                                            </li>
                                            <li class="menu-item-has-children"><a href="#">Demo Group 02</a>
                                                <ul class="dropdown">
                                                    <li><a href="index-7.html">Home 07</a></li>
                                                    <li><a href="index-8.html">Home 08</a></li>
                                                    <li><a href="index-9.html">Home 09</a></li>
                                                    <li><a href="index-10.html">Home 10</a></li>
                                                    <li><a href="index-11.html">Home 11</a></li>
                                                    <li><a href="index-12.html">Home 12</a></li>
                                                </ul>
                                            </li>
                                            <li class="menu-item-has-children"><a href="#">Demo Group 03</a>
                                                <ul class="dropdown">
                                                    <li><a href="index-13.html">Home 13</a></li>
                                                    <li><a href="index-14.html">Home 14</a></li>
                                                    <li><a href="index-15.html">Home 15</a></li>
                                                    <li><a href="index-16.html">Home 16</a></li>
                                                    <li><a href="index-17.html">Home 17</a></li>
                                                    <li><a href="index-18.html">Home 18</a></li>
                                                    <li><a href="index-19.html">Home 19</a></li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </li>
                                    <li class="menu-item-has-children"><a href="#">Pages</a>
                                        <ul class="dropdown">
                                            <li><a href="about-us.html">About Us</a></li>
                                            <li><a href="contact-us.html">Contact Page</a></li>
                                            <li><a href="404.html">404 Page</a></li>
                                            <li><a href="comming-soon.html">Comming Soon 01</a></li>
                                            <li><a href="comming-soon-2.html">Comming Soon 02</a></li>
                                            <li><a href="faq.html">FAQ</a></li>
                                        </ul>
                                    </li>
                                    <li class="menu-item-has-children "><a href="shop-fullwide.html">shop</a>
                                        <ul class="dropdown">
                                            <li class="menu-item-has-children"><a href="#">Shop Layout</a>
                                                <ul class="dropdown">
                                                    <li><a href="shop-fullwide.html">Shop Fullwidth</a></li>
                                                    <li><a href="shop-sidebar.html">Shop Sidebar</a></li>
                                                    <li><a href="shop-metro.html">Shop Metro Layout</a></li>
                                                    <li><a href="shop-3-col.html">Shop 03 Columns</a></li>
                                                    <li><a href="shop-2-col.html">Shop 02 Columns</a></li>
                                                    <li><a href="shop-collection-1.html">Shop Collection 01</a></li>
                                                    <li><a href="shop-collection-2.html">Shop Collection 02</a></li>
                                                </ul>
                                            </li>
                                            <li class="menu-item-has-children"><a href="#">Product Layout</a>
                                                <ul class="dropdown">
                                                    <li><a href="product-details.html">Single 01</a></li>
                                                    <li><a href="product-details-2.html">Single 02</a></li>
                                                    <li><a href="product-details-group.html">Grouped</a></li>
                                                    <li><a href="product-details-sticky.html">Sticky Info</a></li>
                                                    <li><a href="product-details-configurable.html">Configurable</a>
                                                    </li>
                                                    <li><a href="product-details-thumbnail.html">Thumbnail</a></li>
                                                    <li><a href="product-details-video.html">Video</a></li>
                                                    <li><a href="product-details-affiliate.html">Affiliate</a></li>
                                                    <li><a href="product-details-sidebar.html">Sidebar</a></li>
                                                </ul>
                                            </li>
                                            <li class="menu-item-has-children"><a href="#">Shop Pages </a>
                                                <ul class="dropdown">
                                                    <li><a href="my-account.html">My Account</a></li>
                                                    <li><a href="/order">Check Out</a></li>
                                                    <li><a href="cart.html">Shopping Cart</a></li>
                                                    <li><a href="wishlist.html">Wishlist</a></li>
                                                    <li><a href="order-tracking.html">Order Tracking</a></li>
                                                    <li><a href="compare.html">Compare</a></li>
                                                    <li><a href="login-register.html">login / register</a></li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </li>
                                    <li class="menu-item-has-children "><a href="shop-collection-1.html">Collection</a>
                                        <ul class="dropdown">
                                            <li><a href="shop-collection-1.html">Shop Collection 01</a></li>
                                            <li><a href="shop-collection-2.html">Shop Collection 02</a></li>
                                            <li><a href="shop-metro.html">Shop Metro Layout</a></li>
                                        </ul>
                                    </li>
                                    <li class="menu-item-has-children "><a href="blog.html">Blog</a>
                                        <ul class="dropdown">
                                            <li><a href="blog.html">Blog Style 01</a></li>
                                            <li><a href="blog-2.html">Blog Style 02</a></li>
                                            <li><a href="blog-3.html">Blog Style 03</a></li>
                                            <li><a href="blog-details.html">Single Post Style 01</a></li>
                                            <li><a href="blog-details-2.html">Single Post Style 02</a></li>
                                        </ul>
                                    </li>
                                    <li><a href="shop-instagram.html">Instagram Shop </a></li>
                                </ul>
                            </nav>
                            <!-- mobile menu navigation end -->
                        </div>
                        <!-- mobile menu end -->
                    </div>
                    <div class="mobile-curr-lang-wrap">
                        <div class="single-mobile-curr-lang">
                            <a class="mobile-language-active" href="#">Language <i class="fa fa-angle-down"></i></a>
                            <div class="lang-curr-dropdown lang-dropdown-active">
                                <ul>
                                    <li><a href="#">English (US)</a></li>
                                    <li><a href="#">English (UK)</a></li>
                                    <li><a href="#">Spanish</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="single-mobile-curr-lang">
                            <a class="mobile-currency-active" href="#">Currency <i class="fa fa-angle-down"></i></a>
                            <div class="lang-curr-dropdown curr-dropdown-active">
                                <ul>
                                    <li><a href="#">USD</a></li>
                                    <li><a href="#">EUR</a></li>
                                    <li><a href="#">Real</a></li>
                                    <li><a href="#">BDT</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="single-mobile-curr-lang">
                            <a class="mobile-account-active" href="#">My Account <i class="fa fa-angle-down"></i></a>
                            <div class="lang-curr-dropdown account-dropdown-active">
                                <ul>
                                    <li><a href="#">Login</a></li>
                                    <li><a href="#">Creat Account</a></li>
                                    <li><a href="/my-account">My Account</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="header-aside-menu">
                    <nav>
                        <ul>
                            <li><a href="#">About Toro</a></li>
                            <li><a href="#">Help Center</a></li>
                            <li><a href="#">Collection</a></li>
                            <li><a href="#">Blog</a></li>
                            <li><a href="#">New Look</a></li>
                        </ul>
                    </nav>
                </div>
                <img src="assets/images/icon-img/payments.png" alt="payment">
                <p>Pellentesque mollis nec orci id tincidunt. Sed mollis risus eu nisi aliquet, sit amet fermentum justo
                    dapibus.</p>
                <div class="aside-contact-info">
                    <ul>
                        <li><i class="dlicon ui-2_time-clock"></i>Monday - Friday: 9:00 - 19:00</li>
                        <li><i class="dlicon ui-1_email-84"></i>Info@la-studioweb.com</li>
                        <li><i class="dlicon tech-2_rotate"></i>(+55) 254. 254. 254</li>
                        <li><i class="dlicon ui-1_home-minimal"></i>Helios Tower 75 Tam Trinh Hoang - Ha Noi - Viet Nam
                        </li>
                    </ul>
                </div>
                <div class="social-icon-style mb-25">
                    <a class="facebook" href="#"><i class="fa fa-facebook"></i></a>
                    <a class="twitter" href="#"><i class="fa fa-twitter"></i></a>
                    <a class="google-plus" href="#"><i class="fa fa-google-plus"></i></a>
                    <a class="behance" href="#"><i class="fa fa-behance"></i></a>
                </div>
                <div class="copyright">
                    <p>© 2021 <a href="https://hasthemes.com/">Toro.</a> All rights reserved</p>
                </div>
            </div>
        </div>
    </div>
    <div class="breadcrumb-area section-padding-1 bg-gray breadcrumb-ptb-1">
        <div class="container-fluid">
            <div class="breadcrumb-content text-center">
                <div class="breadcrumb-title">
                    <h2>Shop</h2>
                </div>
                <ul>
                    <li>
                        <a href="/home">Home 01 </a>
                    </li>
                    <li><span> &gt; </span></li>
                    <li class="active"> shop </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="shop-area section-padding-1 pt-100 pb-100">
        <div class="container-fluid">
            <div class="shop-top-bar">
                <div class="shop-top-bar-left">
                    <!-- <div class="shop-top-show">
                        <span>Showing 1–12 of 39 results</span>
                    </div>
                    <div class="shop-page-list">
                        <ul>
                            <li>Show</li>
                            <li class="active"><a href="#">12</a></li>
                            <li><a href="#">15</a></li>
                            <li><a href="#">30</a></li>
                        </ul>
                    </div> -->
                </div>
                <div class="shop-top-bar-right">
                    <div class="shop-tab nav">
                        <a href="#shop-1" class="active" data-bs-toggle="tab"><i class="dlicon ui-2_grid-45"></i></a>
                        <a href="#shop-2" data-bs-toggle="tab"><i class="dlicon design_bullet-list-69"></i></a>
                    </div>
                    <div class="shop-short-by ml-50">
                        <a href="/allProducts">Clear filters</a>
                    </div>
                    <div class="shop-filter ml-50">
                        <a class="shop-filter-active" href="#">Filters <i class="fa fa-angle-down angle-down"></i> <i
                                class="fa fa-angle-up angle-up"></i></a>
                    </div>
                    <div class="shop-short-by ml-50">
                        <input type="checkbox" id="sortToggle" style="display: none;">
                        <label for="sortToggle">
                            Sort by <i class="fa fa-angle-down angle-down"></i>
                        </label>
                        <ul>
                            <li><a href="/allProducts?sort=default&q=<%= query %>&priceMin=<%= priceMin %>&priceMax=<%= priceMax %>&brand=<%= brand %>">Default sorting</a></li>
                            <li><a href="/allProducts?sort=latest&q=<%= query %>&priceMin=<%= priceMin %>&priceMax=<%= priceMax %>&brand=<%= brand %>">Sort by latest</a></li>
                            <li><a href="/allProducts?sort=priceAsc&q=<%= query %>&priceMin=<%= priceMin %>&priceMax=<%= priceMax %>&brand=<%= brand %>">Sort by price: low to high</a></li>
                            <li><a href="/allProducts?sort=priceDesc&q=<%= query %>&priceMin=<%= priceMin %>&priceMax=<%= priceMax %>&brand=<%= brand %>">Sort by price: high to low</a></li>
                        </ul>
                        
                    </div>

                </div>
            </div>
            <div class="product-filter-wrapper">
                <div class="row">
                    <!-- Product Filter -->
                    <div class="col-md-3 col-sm-6 col-xs-12 mb-20">
                        <div class="product-filter">
                            <h5>Price</h5>
                            <div class="price-filter">
                                <ul>
                                    <li>
                                        <a href="/allProducts?priceMin=1000&priceMax=4000&sort=<%= sortOption %>&q=<%= query %>&brand=<%= brand %>">
                                            ₹1000 - ₹4000
                                        </a>
                                    </li>
                                    <li>
                                        <a href="/allProducts?priceMin=4000&priceMax=10000&sort=<%= sortOption %>&q=<%= query %>&brand=<%= brand %>">
                                            ₹4000 - ₹10000
                                        </a>
                                    </li>
                                    <li>
                                        <a href="/allProducts?priceMin=10000&priceMax=15000&sort=<%= sortOption %>&q=<%= query %>&brand=<%= brand %>">
                                            ₹10000 - ₹15000
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <!-- Product Filter -->
                    <div class="col-md-3 col-sm-6 col-xs-12 mb-20">
                        <div class="product-filter">
                            <h5>Brands</h5>
                            <div class="product-brands">
                                <ul>
                                    <li>
                                        <a href="/allProducts?brand=Raymond&sort=<%= sortOption %>&q=<%= query %>&priceMin=<%= priceMin %>&priceMax=<%= priceMax %>">
                                            Raymond
                                        </a>
                                    </li>
                                    <li>
                                        <a href="/allProducts?brand=Levis&sort=<%= sortOption %>&q=<%= query %>&priceMin=<%= priceMin %>&priceMax=<%= priceMax %>">
                                            Levis
                                        </a>
                                    </li>
                                    <li>
                                        <a href="/allProducts?brand=Zara&sort=<%= sortOption %>&q=<%= query %>&priceMin=<%= priceMin %>&priceMax=<%= priceMax %>">
                                            Zara
                                        </a>
                                    </li>
                                    <li>
                                        <a href="/allProducts?brand=FabIndia&sort=<%= sortOption %>&q=<%= query %>&priceMin=<%= priceMin %>&priceMax=<%= priceMax %>">
                                            FabIndia
                                        </a>
                                    </li>
                                    <li>
                                        <a href="/allProducts?brand=Puma&sort=<%= sortOption %>&q=<%= query %>&priceMin=<%= priceMin %>&priceMax=<%= priceMax %>">
                                            Puma
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="shop-1" class="tab-pane active">
                <div id="shop-1" class="tab-pane active">
                    <div class="row">
                        <% if(products.length> 0) { %>
                            <% products.forEach(product=> { %>
                                <div class="custom-col-5">
                                    <div class="product-wrap mb-50">
                                        <div class="product-img default-overlay mb-25">
                                            <a href="/product-details?id=<%= product._id %>">
                                                <% if (product.images.length> 0) { %>
                                                    <img class="default-img"
                                                        src="admin/productImages/<%= product.images[0] %>"
                                                        alt="<%= product.name %>">

                                                    <% if (product.stock < 1) { %>
                                                        <span
                                                            class="badge-black badge-right-0 badge-top-0 badge-width-height-1">sold
                                                            out</span>
                                                        <% } %>
                                                            <!-- <% if (product.discountPrice > 0) { %>
                                                        <span class="badge-black badge-left-20 badge-top-20 badge-width-height-2 badge-border-radius-100"></span>
                                                    <% } %> -->

                                                            <% if (product.images.length> 1) { %>
                                                                <img class="hover-img"
                                                                    src="admin/productImages/<%= product.images[1] %>"
                                                                    alt="<%= product.name %>">
                                                                <% } %>

                                                                    <% } else { %>
                                                                        <img class="default-img"
                                                                            src="assets/images/no-image.jpg"
                                                                            alt="No image">
                                                                        <% } %>
                                            </a>

                                            <div class="product-action product-action-position-1">
                                                <a data-bs-toggle="modal" data-bs-target="#exampleModal" href="#"><i
                                                        class="fa fa-eye"></i><span>Quick Shop</span></a>
                                                <a title="Add to Wishlist" href="#"><i class="fa fa-heart"></i><span>Add
                                                        to Wishlist</span></a>
                                                <a class="icon-blod" title="Add to Compare" href="#"><i
                                                        class="dlicon arrows-4_compare"></i><span>Add to
                                                        Compare</span></a>
                                                <a title="Add to Cart" href="#"><i
                                                        class="fa fa-shopping-cart"></i><span>Add to Cart</span></a>
                                            </div>
                                        </div>
                                        <div class="product-content-2 title-font-width-400 text-center">
                                            <h4>
                                                <%= product.brand %>
                                            </h4>
                                            <h3><a href="/product-details?id=<%= product._id %>">
                                                    <%= product.name %>
                                                </a></h3>
                                            <div class="product-price">
                                                <% if (product.discountPrice) { %>
                                                    <span class="new-price">₹<%= product.discountPrice %></span>
                                                    <span class="old-price">₹<%= product.price %></span>
                                                    <% const discountPercentage=Math.round((product.price -
                                                        product.discountPrice) / product.price * 100); %>
                                                        <span class="offer-percentage">(<%= discountPercentage %>%
                                                                OFF)</span>
                                                        <% } else { %>
                                                            <span class="new-price">₹<%= product.price %></span>
                                                            <% } %>
                                            </div>

                                            <style>
                                                .offer-percentage {
                                                    color: rgba(255, 0, 0, 0.84);
                                                }

                                                .new-price {
                                                    font-weight: 600;
                                                }
                                            </style>

                                        </div>
                                    </div>
                                </div>
                                <% }); %>
                                    <% } else { %>
                                        <p>No products available.</p>
                                        <% } %>
                    </div>
                </div>

                <style>
                    .custom-col-5 {
                        width: 20%;
                        float: left;
                        padding: 15px;
                        box-sizing: border-box;
                    }

                    .product-img img {
                        width: 100%;
                        height: 412px;
                        /* Fixed height for all images */
                        object-fit: cover;
                        /* Ensures the image covers the container without distortion */
                        object-position: top;
                        /* Keeps the top part (headspace) of the image in view */
                    }

                    .product-wrap {
                        text-align: center;
                    }

                    .product-action-position-1 a {
                        margin: 5px;
                    }

                    .row:after {
                        content: "";
                        display: table;
                        clear: both;
                    }
                </style>
                <div class="pro-pagination-style text-center">
                    <ul>
                        <% if (currentPage> 1) { %>
                            <!-- Previous Button -->
                            <li>
                                <a href="/allProducts?q=<%= query %>&page=<%= currentPage - 1 %>">
                                    <i class="dlicon arrows-1_tail-left"></i> <!-- Previous icon -->
                                </a>
                            </li>
                            <% } %>

                                <!-- Loop through page numbers -->
                                <% for (let i=1; i <=totalPages; i++) { %>
                                    <li>
                                        <a class="<%= currentPage === i ? 'active' : '' %>"
                                            href="/allProducts?q=<%= query %>&page=<%= i %>">
                                            <%= i %> <!-- Display the page number -->
                                        </a>
                                    </li>
                                    <% } %>

                                        <% if (currentPage < totalPages) { %>
                                            <!-- Next Button -->
                                            <li>
                                                <a href="/allProducts?q=<%= query %>&page=<%= currentPage + 1 %>">
                                                    <i class="dlicon arrows-1_tail-right"></i> <!-- Next icon -->
                                                </a>
                                            </li>
                                            <% } %>
                    </ul>

                </div>
            </div>
        </div>
    </div>
    <%- include ('../layouts/footer') %>